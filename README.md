# 一站式评测工具 (One-Stop Eval)

> **全自动问答生成与质量评测工作流工具**  
> *基于 Streamlit + LLM (OpenAI/OpenRouter)*

![License](https://img.shields.io/badge/license-MIT-blue.svg) ![Python](https://img.shields.io/badge/python-3.8+-green.svg)

## 📖 简介

**一站式评测工具** 旨在解决大模型应用开发中的痛点：**“如何批量评估模型的回答质量？”**。

它提供了一个优雅的图形界面，引导您完成从“批量提问”到“制定标准”再到“自动打分”的全流程。核心特色包括：

*   **⚡ 一站式工作流**：无需切换工具，在一个界面完成所有操作。
*   **🤖 智能评分标准**：内置“打分专家”Agent，能根据您的数据自动生成精准的 0-5 分评分规则。
*   **🔒 隐私安全**：API Key 仅在本地运行，支持临时使用，不上传云端。
*   **📊 结构化输出**：最终生成包含 QA 对、评分、评语的 Excel 报表。

---

## 🚀 快速开始

### 1. 环境准备

确保您的电脑已安装 [Python 3.8 或更高版本](https://www.python.org/downloads/)。

### 2. 安装依赖

下载本项目后，在项目根目录打开终端，运行：

```bash
pip install -r requirements.txt
```

### 3. 启动工具

**方式 A (推荐)**：直接双击运行文件夹中的 `start_tool.bat`。

**方式 B (命令行)**：
```bash
streamlit run app.py
```

---

## 🛠️ 详细操作指南

### 第一步：配置与导入

1.  **填写 API Key**：
    *   在左侧边栏输入您的 OpenRouter 或 OpenAI API Key。
    *   *提示：默认使用 `google/gemini-2.5-flash` 模型，经济实惠且速度快。*
2.  **上传数据**：
    *   点击“Browse files”上传您的 Excel 文件 (`.xlsx`)。
    *   **Excel 格式要求**：至少包含一列“问题”或“数据源”。
3.  **列名映射**：
    *   系统会自动识别列名，如有误请手动调整：
        *   **数据源列**：参考材料（RAG 的检索内容）。
        *   **问题集列**：用户的问题。
        *   **生成答案列名**：程序将把生成的答案填入此列。

### 第二步：执行工作流 (Step by Step)

#### 1️⃣ Step 1: 批量生成答案
*   **功能**：根据“数据源”和“问题”，调用大模型生成回答。
*   **操作**：
    *   编辑 `System Prompt`（指导模型如何回答）。
    *   点击 **“执行生成 (Step 1)”**。
    *   程序会自动处理 Excel 中的每一行。

#### 2️⃣ Step 2: 智能生成评分标准
*   **功能**：这是本工具的核心。它会分析您的数据，自动写出一套“评分 Prompt”。
*   **操作**：
    *   点击 **“自动生成评测 Prompt”**。
    *   **专家模式**：内置的 AI 专家会生成一套强制输出 **0-5 分纯数字** 的规则，杜绝废话。
    *   您可以手动微调生成的 Prompt，满意后点击 **“确认 Prompt 并继续”**。

#### 3️⃣ Step 3: 批量自动打分
*   **功能**：AI 裁判员根据 Step 2 的标准，对 Step 1 的回答进行打分。
*   **操作**：
    *   点击 **“开始评测 (Step 3)”**。
    *   完成后，界面会展示平均分分布。

### 第三步：导出结果

*   点击页面底部的 **“📥 下载评测结果 (Excel)”** 按钮，获取包含所有过程数据的最终报表。

---

## ❓ 常见问题 (FAQ)

**Q: 为什么生成的评分不是数字？**
A: 请确保在 Step 2 中使用了默认的“专家 Prompt”。我们已对元 Prompt 进行了深度优化，强制要求模型只输出 0-5 的整数。

**Q: 支持本地模型 (Ollama) 吗？**
A: 支持。只需在侧边栏修改 `API Base URL` 为 `http://localhost:11434/v1`，并将 API Key 设为任意字符（如 `ollama`）即可。

**Q: 如何更新代码？**
A: 本地修改代码后，双击运行 `update_repo.bat` 即可自动同步到 GitHub。

---

*Designed by mingqu72 | Powered by Trae IDE*